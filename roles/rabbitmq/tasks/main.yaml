  - name: Copying rabbitmq repo 
    ansible.builtin.copy: 
     src: rabbitmq.repo 
     dest: /etc/yum.repos.d/rabbitmq.repo

  - name: Install rabbitmq-server 
    ansible.builtin.package: 
     name: rabbitmq-server
     state: present 

  - name: start and enable rabbitmq-server 
    ansible.builtin.service: 
     name: rabbitmq-server
     state: started 
     enabled: yes  

  - name: create and provide permissions to user 
    community.rabbitmq.rabbitmq_user:
      user: {{ RABBITMQ_USER }}
      password: {{ RABBITMQ_PASS }}
      permissions:
        - vhost: /
          configure_priv: .*
          read_priv: .*
          write_priv: .*
      state: present